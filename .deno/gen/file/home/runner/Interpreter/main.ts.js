import * as path from " https://deno.land/std/path/mod.ts ";
import { Parser, Runtime, Tokenizer } from '@core/stages/mod.ts';
switch (Deno.args[0]) {
    case 'run': {
        const filePath = Deno.args[1];
        const dirname = path.dirname(path.fromFileUrl(import.meta.url));
        const input = await Deno.readTextFile(path.join(dirname, filePath));
        interpreter(input);
        break;
    }
    case '': {
        console.log('\nMathpreter v0.1');
        while (true) {
            const input = prompt('> ');
            if (!input)
                continue;
            if (input === '.exit') {
                Deno.exit(1);
            }
            interpreter(input);
            break;
        }
    }
}
function interpreter(input) {
    try {
        const tokens = new Tokenizer(input).returns;
        const program = new Parser(tokens).returns;
        const result = new Runtime(program).returns;
        console.log(result?.value);
    }
    catch (e) {
        console.error(e);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIm1haW4udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxLQUFLLElBQUksTUFBTSxxQ0FBcUMsQ0FBQztBQUM1RCxPQUFPLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQTtBQUVoRSxRQUFRLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUU7SUFDckIsS0FBSyxLQUFLLENBQUMsQ0FBQztRQUNYLE1BQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDOUIsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUVoRSxNQUFNLEtBQUssR0FBRyxNQUFNLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQztRQUNwRSxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUM7UUFFbkIsTUFBTTtLQUNOO0lBQ0QsS0FBSyxFQUFFLENBQUMsQ0FBQztRQUNSLE9BQU8sQ0FBQyxHQUFHLENBQUMsbUJBQW1CLENBQUMsQ0FBQztRQUVqQyxPQUFNLElBQUksRUFBRTtZQUNULE1BQU0sS0FBSyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUMzQixJQUFHLENBQUMsS0FBSztnQkFBRSxTQUFTO1lBRXBCLElBQUcsS0FBSyxLQUFLLE9BQU8sRUFBRTtnQkFDbEIsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQzthQUNoQjtZQUVELFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUVyQixNQUFNO1NBQ047S0FDRDtDQUNEO0FBRUQsU0FBUyxXQUFXLENBQUMsS0FBYTtJQUNoQyxJQUFJO1FBQ0UsTUFBTSxNQUFNLEdBQUcsSUFBSSxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDO1FBQzVDLE1BQU0sT0FBTyxHQUFHLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQztRQUMzQyxNQUFNLE1BQU0sR0FBRyxJQUFJLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFPLENBQUM7UUFFNUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsS0FBSyxDQUFDLENBQUM7S0FDOUI7SUFBQyxPQUFNLENBQUMsRUFBRTtRQUNQLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7S0FDdEI7QUFDSCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgcGF0aCBmcm9tIFwiIGh0dHBzOi8vZGVuby5sYW5kL3N0ZC9wYXRoL21vZC50cyBcIjtcbmltcG9ydCB7IFBhcnNlciwgUnVudGltZSwgVG9rZW5pemVyIH0gZnJvbSAnQGNvcmUvc3RhZ2VzL21vZC50cydcblxuc3dpdGNoIChEZW5vLmFyZ3NbMF0pIHtcblx0Y2FzZSAncnVuJzoge1xuXHRcdGNvbnN0IGZpbGVQYXRoID0gRGVuby5hcmdzWzFdO1xuXHRcdGNvbnN0IGRpcm5hbWUgPSBwYXRoLmRpcm5hbWUocGF0aC5mcm9tRmlsZVVybChpbXBvcnQubWV0YS51cmwpKTtcblx0XHRcblx0XHRjb25zdCBpbnB1dCA9IGF3YWl0IERlbm8ucmVhZFRleHRGaWxlKHBhdGguam9pbihkaXJuYW1lLCBmaWxlUGF0aCkpO1xuXHRcdGludGVycHJldGVyKGlucHV0KTtcblxuXHRcdGJyZWFrO1xuXHR9XG5cdGNhc2UgJyc6IHtcblx0XHRjb25zb2xlLmxvZygnXFxuTWF0aHByZXRlciB2MC4xJyk7XG5cblx0XHR3aGlsZSh0cnVlKSB7XG5cdCAgICBjb25zdCBpbnB1dCA9IHByb21wdCgnPiAnKTtcblx0ICAgIGlmKCFpbnB1dCkgY29udGludWU7XG5cdFxuXHQgICAgaWYoaW5wdXQgPT09ICcuZXhpdCcpIHtcblx0ICAgICAgICBEZW5vLmV4aXQoMSk7XG5cdCAgICB9XG5cdFxuXHQgICAgaW50ZXJwcmV0ZXIoaW5wdXQpO1xuXG5cdFx0XHRicmVhaztcblx0XHR9XG5cdH1cbn1cblxuZnVuY3Rpb24gaW50ZXJwcmV0ZXIoaW5wdXQ6IHN0cmluZykge1xuXHRcdHRyeSB7XG4gICAgICAgIGNvbnN0IHRva2VucyA9IG5ldyBUb2tlbml6ZXIoaW5wdXQpLnJldHVybnM7XG4gICAgICAgIGNvbnN0IHByb2dyYW0gPSBuZXcgUGFyc2VyKHRva2VucykucmV0dXJucztcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IFJ1bnRpbWUocHJvZ3JhbSkucmV0dXJuczsgXG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQ/LnZhbHVlKTtcbiAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlKTtcblx0XHR9XG59Il19